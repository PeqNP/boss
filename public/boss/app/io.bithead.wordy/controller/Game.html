<div class="ui-window" style="width: 390px;">
  <script language="text/javascript">
    function $(this.id)(view) {
      function userDidSignIn(user) {
        view.ui.element("wordySplash").style.display = 'none';
        view.ui.element("wordyGame").style.display = 'block';
      }
      this.userDidSignIn = userDidSignIn;

      function userDidSignOut() {
        view.ui.element("wordySplash").style.display = 'block';
        view.ui.element("wordyGame").style.display = 'none';
      }
      this.userDidSignOut = userDidSignOut;

      async function viewDidLoad() {
        // Load stylesheet
        await os.network.stylesheet("$(app.resourcePath)/styles.css");

        view.ui.element("wordySplash").style.display = 'none';
        view.ui.element("wordyGame").style.display = 'none';
        if (os.isGuestUser(os.user)) {
          view.ui.element("wordySplash").style.display = 'block';
        }
        else {
          view.ui.element("wordyGame").style.display = 'block';
        }
      }
      this.viewDidLoad = viewDidLoad;

      // `addLetter` and `submitGuess` must be wrapped as the wordyGame UIController are not
      // defined by the time this controller is intialized.
      function addLetter(letter) {
        if (letter == "Backspace") {
          %(wordyGame).removeLetter();
        }
        else {
          %(wordyGame).addLetter(letter);
        }
      }
      function submitGuess() {
        %(wordyGame).submitGuess();
      }

      // Note: Key listeners must be defined on window.
      this.didHitKey = addLetter;
      this.didHitEnter = submitGuess;
    }
  </script>
  <div class="top">
    <div class="close-button"></div>
    <div class="title"><span>Wordy</span></div>
  </div>

  <div class="ui-controller container add-5" id="wordyGame">
    <script language="text/javascript">
      function wordyGame(view) {
        let selectedButton;

        function selectButton(buttonName) {
          // De-select the current button
          if (!isEmpty(selectedButton)) {
            view.ui.element(selectedButton).classList.remove("selected");
          }

          // Select the button
          view.ui.element(buttonName).classList.add("selected");
          selectedButton = buttonName;
        }

        function showFriends() {
          selectButton("wordy-nav-friends");
        }
        this.showFriends = showFriends;

        function showStats() {
          selectButton("wordy-nav-stats");
        }
        this.showStats = showStats;

        function showGame() {
          selectButton("wordy-nav-game");
        }
        this.showGame = showGame;

        function showSolver() {
          selectButton("wordy-nav-solver");
        }
        this.showSolver = showSolver;

        /**
         * Enter a letter into the guess.
         */
        function addLetter(letter) {
          // If 5 letters already entered, do nothing.
          console.log(`add letter (${letter})`);

          // Must be an alphabetic value
          const isAlpha = /^[a-zA-Z]$/.test(letter);
          if (!isAlpha) {
            return;
          }
        }
        this.addLetter = addLetter;

        /**
         * Remove letter from guess.
         */
        function removeLetter() {
          console.log("remove letter");
        }
        this.removeLetter = removeLetter;

        /**
         * Submit guess to server.
         */
        function submitGuess() {
          // Do not submit guess unless at least 5 letters are provided
          console.log("submit guess");
        }
        this.submitGuess = submitGuess;

        function viewDidLoad(view) {
          selectButton("wordy-nav-game");
        }
        this.viewDidLoad = viewDidLoad;
      }
    </script>
    <div class="vbox gap-20">
      <div class="hbox separated" width="100%">
        <p id="wordy-title">Wordy</p>
        <div class="hbox align-right">
          <button id="wordy-nav-friends" class="image" onclick="%(wordyGame).showFriends();"><img src="$(app.resourcePath)/img/friend.svg" width="20" height="20"></button>
          <button id="wordy-nav-stats" class="image" onclick="%(wordyGame).showStats();"><img src="$(app.resourcePath)/img/podium.svg" width="20" height="20"></button>
          <button id="wordy-nav-game" class="image" onclick="%(wordyGame).showGame();"><img src="$(app.resourcePath)/icon.svg" width="20" height="20"></button>
          <button id="wordy-nav-solver" class="image" onclick="%(wordyGame).showSolver();"><img src="$(app.resourcePath)/img/solver.svg" width="20" height="20"></button>
        </div>
      </div>

      <div class="vbox align-center gap-5"> <!-- Game board -->
        <div class="wordy-guess" id="guess-0">
          <button class="letter-0 hit">A</button>
          <button class="letter-1 miss">L</button>
          <button class="letter-2 miss">E</button>
          <button class="letter-3 found">R</button>
          <button class="letter-4 miss">T</button>
        </div>
        <div class="wordy-guess" id="guess-1">
          <button class="letter-0 commit">A</button>
          <button class="letter-1"></button>
          <button class="letter-2"></button>
          <button class="letter-3"></button>
          <button class="letter-4"></button>
        </div>
        <div class="wordy-guess" id="guess-2">
          <button class="letter-0"></button>
          <button class="letter-1"></button>
          <button class="letter-2"></button>
          <button class="letter-3"></button>
          <button class="letter-4"></button>
        </div>
        <div class="wordy-guess" id="guess-3">
          <button class="letter-0"></button>
          <button class="letter-1"></button>
          <button class="letter-2"></button>
          <button class="letter-3"></button>
          <button class="letter-4"></button>
        </div>
        <div class="wordy-guess" id="guess-4">
          <button class="letter-0"></button>
          <button class="letter-1"></button>
          <button class="letter-2"></button>
          <button class="letter-3"></button>
          <button class="letter-4"></button>
        </div>
        <div class="wordy-guess" id="guess-5">
          <button class="letter-0"></button>
          <button class="letter-1"></button>
          <button class="letter-2"></button>
          <button class="letter-3"></button>
          <button class="letter-4"></button>
        </div>
      </div> <!-- Game board -->

      <div class="vbox gap-10 wordy-keyboard"> <!-- Keyboard -->
        <div class="hbox gap-5 align-center">
          <button onclick="%(wordyGame).addLetter('A');">Q</button>
          <button>W</button>
          <button>E</button>
          <button>R</button>
          <button>T</button>
          <button>Y</button>
          <button>U</button>
          <button>I</button>
          <button>O</button>
          <button>P</button>
        </div>

        <div class="hbox gap-5 align-center">
          <button>A</button>
          <button>S</button>
          <button>D</button>
          <button>F</button>
          <button>G</button>
          <button>H</button>
          <button>J</button>
          <button>K</button>
          <button>L</button>
        </div>

        <div class="hbox gap-5 align-center">
          <button class="action" onclick="%(wordyGame).submitGuess();">return</button>
          <button>Z</button>
          <button>X</button>
          <button>C</button>
          <button>V</button>
          <button>B</button>
          <button>N</button>
          <button>M</button>
          <button class="action" onclick="%(wordyGame).removeLetter();">delete</button>
        </div>
      </div> <!-- Keyboard -->
    </div>
  </div> <!-- wordyGame -->

  <!-- First thing user sees if not signed in. -->
  <div class="ui-controller container" id="wordySplash">
    <script type="text/javascript">
      function wordySplash(view) {
        function showSignIn() {
          os.ui.showSignIn();
          console.log("showSignIn");
        }
        this.showSignIn = showSignIn;

        function showCreateAccount() {
          os.ui.showCreateAccount();
        }
        this.showCreateAccount = showCreateAccount;
      }
    </script>
    <div class="vbox gap-10">
      <p>Welcome to Wordy! The open source, 5 letter, guessing game.</p>
      <p>In order to play, you must sign in. If you don't have one, please create one (It's free).</p>
      <div class="controls">
        <button class="default" onclick="%(wordySplash).showCreateAccount();">Create account</button>
        <button class="default" onclick="%(wordySplash).showSignIn();">Sign in</button>
      </div>
    </div>
  </div>
</div>
